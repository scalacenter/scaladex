@import ch.epfl.scala.index.views.html.contributingInfo
@import scaladex.core.model.Project
@import scaladex.core.model.Artifact
@import akka.http.scaladsl.model.headers.LinkParams.title
@import scaladex.core.model.Env
@import scaladex.core.model.UserState
@import scaladex.core.model.SemanticVersion
@import scaladex.core.model.Platform
@import scaladex.core.model.TwitterSummaryCard
@import scaladex.core.model.ArtifactDependency
@import ch.epfl.scala.index.views.html.main

@(
  production: Boolean, env: Env, project: Project, artifacts: Seq[Artifact.Name], versions: Seq[SemanticVersion],
  platforms: Seq[Platform], release: Artifact, user: Option[UserState],
  canEdit: Boolean, twitterCard: Option[TwitterSummaryCard], releaseCount: Int,
  directDependencies: Seq[ArtifactDependency.Direct], reverseDependency: Seq[ArtifactDependency.Reverse]
)

@main(production, title = project.repository.value, showSearch = true, user,
      extraMeta = twitterCard.map(_.toHeadMeta).getOrElse(Nil)) {
  <main id="container-project">
    @headproject(project, artifacts, versions, platforms, release, canEdit)
    <div class="container">
      <div class="row">
        <div class="col-md-8">
          <div class="content-project box" id="README" 
            data-organization="@project.reference.organization"
            data-repository="@project.reference.repository">

            @Html(project.githubInfo.flatMap(_.readme).getOrElse(""))
          </div>
        </div>
        <div class="col-md-4">
          <div class="sidebar-project">
            @if(project.settings.artifactDeprecations.contains(release.artifactName)) {
            <div class="box">
              <h1>[DEPRECATED]</h1>
            </div>
            }
            @documentation(release, project)
            @badges(release, env)
            @install(release, project.settings.cliArtifacts)
            @scastie(release.scastieURL)
            @project.githubInfo.map(gh => statistic(gh, project.reference, releaseCount, reverseDependency.size))
            @project.githubInfo.map { github =>
              @if(github.beginnerIssues.nonEmpty && github.chatroom.isDefined && github.contributingGuide.isDefined) {
                  <div class="box project-contributing-info">
                    <h4>Contributing Info</h4>
                    <p>Beginner-friendly Issues:</p>
                    <div>
                      @contributingInfo(project)
                    </div>
                  </div>
              }
            }
            @project.githubInfo.map(gh => contributors(gh.contributors))
            @license(release)
            @dependencies(project.reference, directDependencies)
            @dependents(release, reverseDependency)
          </div>
        </div>
      </div>
    </div>
  </main>
}
