@import scaladex.view.html.ensureUri
@import scaladex.core.model.Project
@import scaladex.view.Formats._
@import scaladex.core.model.UserState
@import scaladex.core.model.Env

@import scaladex.core.model.SemanticVersion
@(env: Env, user: Option[UserState], project: Project, numberOfVersions: Long, activeTab: String, lastVersion: SemanticVersion)

@canEdit = @{user.exists(_.canEdit(project.reference, env))}
@isActive(nameTab: String) = @{if(nameTab == activeTab) "active" else ""}
@if(project.settings.deprecated) {
  <div class="deprecated-project">
    This repository has been deprecated by the owner.
  </div>
}
<div class="head-project">
  <div class="container">
    <div class="info-project">
      <div class="row">
        <div class="col-md-12">
          <h1>
            <a href="/@project.organization">@project.organization</a> /
            <a href="/@project.reference">@project.repository</a>
            <div class="head-last-version">&nbsp;&nbsp;@lastVersion.encode </div>
          </h1>

          @if(project.settings.contributorsWanted) {
            <a class="contributors-tag" href="/search?q=contributorsWanted:true">
              <img src="/assets/img/contributors_tag.png" alt="Contributors Wanted">
            </a>
          }
          @for(github <- project.githubInfo) {
            @for(homepage <- github.homepage) {
              @if(homepage.target.nonEmpty) {
                <a href="@ensureUri(homepage.target)" class="btn btn-link" target="_blank" rel="nofollow">
                  <i class="fa-solid fa-earth-africa" aria-hidden="true"></i> Website
                </a>
              }
            }
          }
          <a href="https://github.com/@project.reference" class="btn btn-link" target="_blank"><i class="fa-brands fa-github"></i>
            GitHub</a>
        </div>
      </div>
      @for(github <- project.githubInfo) {
        @for(description <- github.description) {
          @if(description.nonEmpty) {
            <p class="description emojify">@description</p>
          }
        }
      }
      @for(github <- project.githubInfo) {
        <ul class="list-inline">
        @for(topic <- github.topics) {
          <li><a href="/search?topics=@topic" class="label label-default">@topic</a></li>
        }
        </ul>
      }
    </div>
    <div class="row">
      <div class="col-md-12">
        <div class="project-nav-bar">
          <ul class="nav nav-tabs">
            <li role="project" class="@isActive("Project")"><a href="/@project.reference">Project</a></li>
            <li role="artifacts" class="@isActive("Artifacts")"><a href="/@project.reference/artifacts">@plural(numberOfVersions, "Version")</a></li>
            <li role="version-matrix" class="@isActive("Version Matrix")"><a href="/@project.reference/version-matrix">Version Matrix</a></li>
            <li role="badges" class="@isActive("Badges")"><a href="/@project.reference/badges">Badges</a></li>
            @if(canEdit) {
              <li role="settings" class="@isActive("Settings")">
                <a data-toggle="tooltip" data-placement="bottom" title="edit project's settings" href="/@project.reference/settings">
                  <i class="fa-solid fa-gear"></i>
                  Settings
                </a>
              </li>
            }
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
